{"version":3,"file":"toy-vue.js","sources":["../src/compiler/parse.js","../src/compiler/index.js","../src/utils/index.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); \r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);  \r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;  \r\n\r\nconst startTagClose = /^\\s*(\\/?)>/;  \r\n\r\n\r\n/**\r\n * 把模板转换为AST树\r\n * @param {*} html \r\n * @returns \r\n */\r\nexport function parseHTML(html) { \r\n\r\n    const ELEMENT_TYPE = 1;\r\n    const TEXT_TYPE = 3;\r\n    const stack = []; \r\n    let currentParent; \r\n    let root;\r\n\r\n    // 生成AST节点\r\n    function createASTElement(tag, attrs) {\r\n        return {\r\n            tag,\r\n            type: ELEMENT_TYPE,\r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        }\r\n    }\r\n\r\n    // 开始标签\r\n    function start(tag, attrs) {\r\n        let node =  createASTElement(tag,attrs); \r\n        if(!root){ \r\n            root = node; \r\n        } \r\n        if(currentParent){\r\n            node.parent = currentParent; \r\n            currentParent.children.push(node); \r\n        }\r\n        stack.push(node);\r\n        currentParent = node; \r\n    }\r\n    // 文本\r\n    function chars(text) { \r\n        text = text.replace(/\\s/g,' '); \r\n        text && currentParent.children.push({\r\n            type:TEXT_TYPE,\r\n            text,\r\n            parent:currentParent\r\n        });\r\n    }\r\n    // 结束标签\r\n    function end(tag) {\r\n       let node =  stack.pop();  \r\n       currentParent = stack[stack.length - 1];\r\n    }\r\n    // 截取html\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n    // 解析开始标签\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1], \r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n            \r\n            let attr, end\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                advance(attr[0].length);\r\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] || true })\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n            }\r\n            return match;\r\n        }\r\n        return false; \r\n    }\r\n    while (html) {\r\n        \r\n        let textEnd = html.indexOf('<');  \r\n        if (textEnd == 0) {\r\n            const startTagMatch = parseStartTag(); \r\n            if (startTagMatch) { \r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1])\r\n                continue;\r\n            }\r\n        }\r\n        if (textEnd > 0) {\r\n            let text = html.substring(0, textEnd); \r\n            if (text) {\r\n                chars(text)\r\n                advance(text.length); \r\n            }\r\n        }\r\n    }\r\n    \r\n\r\n    return root;\r\n}","import { parseHTML } from \"./parse\";\r\n\r\n\r\n/**\r\n * \r\n * _c 创建元素\r\n * _v 创建文本 \r\n * _s 拼接文本\r\n * \r\n */\r\n\r\n// 生成属性字符串\r\nfunction genProps(attrs) {\r\n    let str = ''\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === 'style') {\r\n           \r\n            let obj = {};\r\n            attr.value.split(';').forEach(item => { \r\n                let [key, value] = item.split(':');\r\n                obj[key] = value;\r\n            });\r\n            attr.value = obj\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},` \r\n    }\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\n\r\n// 小胡子正则\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; \r\n\r\n\r\n// 生成代码\r\nfunction gen(node) {\r\n    if (node.type === 1) {\r\n        return codegen(node);\r\n    } else {\r\n     \r\n        let text = node.text\r\n        if (!defaultTagRE.test(text)) {\r\n            return `_v(${JSON.stringify(text)})`\r\n        } else {\r\n           \r\n            let tokens = [];\r\n            let match;\r\n            defaultTagRE.lastIndex = 0;\r\n            let lastIndex = 0;\r\n         \r\n            while (match = defaultTagRE.exec(text)) {\r\n                let index = match.index; \r\n                if (index > lastIndex) {\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`)\r\n                lastIndex = index + match[0].length\r\n            }\r\n            if (lastIndex < text.length) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join('+')})`\r\n        }\r\n    }\r\n}\r\nfunction genChildren(children) {\r\n    return children.map(child => gen(child)).join(',')\r\n}\r\nfunction codegen(ast) {\r\n    let children = genChildren(ast.children);\r\n    let code = (`_c('${ast.tag}',${ast.attrs.length > 0 ? genProps(ast.attrs) : 'null'\r\n        }${ast.children.length ? `,${children}` : ''\r\n        })`)\r\n\r\n    return code;\r\n}\r\nexport function compileToFunction(template) {\r\n    let ast = parseHTML(template);\r\n    let code = codegen(ast);\r\n    code = `with(this){return ${code}}`;\r\n    let render = new Function(code); \r\n    return render;\r\n}\r\n","export function isObject(val) {\r\n    return val!== null && typeof val === 'object';\r\n}\r\n\r\nexport function isFunction(val) {\r\n    return typeof val === 'function';\r\n}\r\n\r\nexport function isElement(ele) {\r\n    return ele.nodeType === 1;\r\n}\r\n\r\nexport function isString(ele) {\r\n    return typeof ele === 'string';\r\n}","\r\nlet oldArrayProto = Array.prototype;\r\n\r\nexport let newArrayProto = Object.create(oldArrayProto);\r\n\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n   'shift',\r\n    'unshift',\r\n   'reverse',\r\n   'sort',\r\n   'splice'\r\n];\r\n\r\nmethods.forEach(method => {\r\n    newArrayProto[method] = function (...args) {\r\n        const result = oldArrayProto[method].call(this,...args);\r\n        let inserted;\r\n        let ob = this.__ob__;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case'splice':\r\n                inserted = args.slice(2);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (inserted) ob.observeArray(inserted);\r\n        // ob.dep.notify();\r\n        return result;\r\n    }\r\n})","import { isObject } from \"../utils\";\r\nimport { newArrayProto } from \"./array\";\r\n\r\nclass Observer {\r\n    constructor(value) {\r\n        // 这也太巧妙了吧\r\n        // 给数据加了一个标识，如果数据上有__ob__则说明被观测过\r\n        Object.defineProperty(value, '__ob__', {\r\n            value: this,\r\n            enumerable: false,\r\n        })\r\n\r\n        if (Array.isArray(value)) {\r\n            value.__proto__ = newArrayProto;\r\n            this.observeArray(value);\r\n        } else {\r\n            this.walk(value);\r\n        } \r\n    }\r\n    walk(obj) {\r\n        const keys = Object.keys(obj);\r\n        for (let i = 0; i < keys.length; i++) {\r\n            defineReactive(obj, keys[i], obj[keys[i]]);\r\n        }\r\n    }\r\n    observeArray(arr) {\r\n        arr.forEach(item => observe(item))\r\n    }\r\n}\r\n\r\nexport function defineReactive(obj, key, value) {\r\n    // key 对应 的 value 可能是对象\r\n    observe(value);\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            return value;\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value) return;\r\n            // 如果用户设置的是一个对象，应该将其进行劫持\r\n            observe(newValue);\r\n            value = newValue;\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport function observe(data) {\r\n    if (!isObject(data)) return;\r\n    if (data.__ob__ instanceof Observer) return data.__ob__;\r\n    return new Observer(data);\r\n}","import { observe } from \"./observe\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    // if (opts.props) {\r\n    //     initProps(vm, opts.props);\r\n    // }\r\n    // if (opts.methods) {\r\n    //     initMethods(vm, opts.methods);\r\n    // }\r\n    if (opts.data) {\r\n        initData(vm);\r\n    }\r\n    // if (opts.computed) {\r\n    //     initComputed(vm, opts.computed);\r\n    // }\r\n}\r\n\r\n\r\nfunction proxy(vm, target, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[target][key];\r\n        },\r\n        set(newValue) {\r\n            vm[target][key] = newValue;\r\n        }\r\n    })\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n\r\n    observe(data)\r\n\r\n    for (let key in data) {\r\n        proxy(vm, '_data', key);\r\n    }\r\n}","import { compileToFunction } from \"./compiler\";\r\nimport { initState } from \"./state\";\r\nimport { isElement, isString } from \"./utils\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;\r\n\r\n        // 状态初始化\r\n        initState(vm);\r\n        let el = options.el;\r\n\r\n        if (el) {\r\n            vm.$mount(el);\r\n        }\r\n    }\r\n\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this;\r\n        el = document.querySelector(el);\r\n        let opts = vm.$options\r\n        if (!opts.render) { \r\n            let template; \r\n            if (!opts.template && el) { \r\n                template = el.outerHTML\r\n            } else {\r\n                if (el) {\r\n                    template = opts.template \r\n                }\r\n            }\r\n            if (template && el) {\r\n                const render = compileToFunction(template);\r\n                opts.render = render;\r\n            }\r\n        }\r\n        console.log(opts.render);\r\n        \r\n    }\r\n}","import { initMixin } from \"./init\";\r\n\r\nfunction TVue(options){ \r\n    this._init(options); \r\n}\r\n\r\n// 把_init挂到TVue原型链上\r\ninitMixin(TVue); \r\n\r\nexport default TVue"],"names":["ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","parent","start","node","push","chars","text","replace","end","pop","length","advance","n","substring","parseStartTag","match","tagName","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","genProps","str","i","obj","split","forEach","item","key","JSON","stringify","slice","defaultTagRE","gen","codegen","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","child","ast","code","compileToFunction","template","render","Function","isObject","val","isFunction","oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","method","args","result","call","inserted","ob","__ob__","observeArray","Observer","constructor","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","arr","observe","get","set","newValue","data","initState","vm","opts","$options","initData","proxy","target","_data","initMixin","Vue","_init","options","el","$mount","document","querySelector","outerHTML","console","log","TVue"],"mappings":"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"}